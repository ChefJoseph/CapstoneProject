'use strict';

import { BackAndroid } from 'react-native';

const listeners = [];

BackAndroid.addEventListener('hardwareBackPress', () => {
  for (let i = listeners.length - 1; i >= 0; i--) {
    if (listeners[i]()) {
      return true;
    }
  }
  return false;
});


export function addBackPressListener(listener:Function): Object {
  if (listener) {
    if (listeners.indexOf(listener) > -1) {
      console.error('onBackPress...listener already exists');
      return {
        remove: () => {
        }
      }
    } else {
      listeners.push(listener);
      return {
        remove: () => {
          console.log('BackAndroid...remove listener');
          let index = listeners.indexOf(listener);
          if (index > -1) {
            listeners.splice(index, 1);
          }
        }
      }
    }
  }
}

export function exitApp() {
  BackAndroid.exitApp();
}